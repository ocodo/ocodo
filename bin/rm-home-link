#!/usr/bin/env zsh

homepage_folder=$HOME/workspace/ocodo
cd $homepage_folder

echo "Remove ocodo homepage link"
remove_at=$(cat index.md \
    | fzf --no-sort --reverse --height 20 \
    --header "Select link to remove" \
    | grep -E -o '^\s+([0-9]+)' \
    | tr -d '[:space:]')

temp=$(mktemp)

echo "$remove_at"

sed "/$remove_at/d" < index.md > "$temp"
mv "$temp" index.md

bin/build

git diff

echo "--------------------------------------------------------------------------------"

all_ok=$(echo "y\nn" | fzf \
    --reverse \
    --header "All ok? If (y) we'll commit and push to GitHub" \
    --no-sort --height 6)

git add .
git commit -m "added ${title}"
git pull --rebase
git push
